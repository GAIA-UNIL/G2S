<!DOCTYPE html>
<html>
<head>
	<title>G2S a free and flexible MPS framework, including QS and NDS  </title>
	<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
	<link rel="stylesheet" href="./style.css" media="screen" type="text/css">
	<link rel="stylesheet" href="./print.css" media="print" type="text/css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://kit.fontawesome.com/7dc3015a44.js" crossorigin="anonymous"></script>
	<script src="./scripte.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/intellij-light.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/matlab.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/snapsvg@0.5.1/dist/snap.svg.min.js"></script>
	<script src="qsDynamicSim.js"></script>
	<!-- <script>hljs.highlightAll();</script> -->
</head>
<body>
	<header>
		<div class="inner">
			<a><h1>G2S: The GeoStatistical Server</h1></a>
			<h2>A free and flexible multiple point (geo)statistics framework including state-of-the-art algorithms:<br>QuickSampling and Narrow Distribution 
				Selection</h2>
			<a href="https://github.com/GAIA-UNIL/G2S" class="button"><small>View project on</small> GitHub</a>
			<a href="https://github.com/GAIA-UNIL/G2S/zipball/master" class="button download" style="top: 85px;"><small>Download</small>.zip file</a>
			<a href="https://github.com/GAIA-UNIL/G2S/tarball/master" class="button download" style="top: 170px;"><small>Download</small>.tar.gz file</a>
			<p class="repo-owner"><a href="https://github.com/GAIA-UNIL/G2S">G2S</a> is maintained by <a href="https://github.com/GAIA-UNIL/"> the GAIAlab from University of Lausanne</a>.</p>
		</div>
	</header>
	<div id="content-wrapper">
		<div class="inner clearfix">
			<aside id='menuSidebar' class='sideMenuBar'>
				<div>
					<aside id="menu">
						<ul class='sideMenu'>							
							<li><a href="#briefOverview">Brief overview</a></li>
							<li><a href="#install">Installation</a></li>
							<ul>
								<li><a href="#installServer">Installation of the server</a></li>
								<li><a href="#installInter">Installation of interfaces</a></li>
							</ul>
							<li><a href="#runServer">Run the server</a></li>
							<li><a href="#userInterface">Using the interfaces</a></li>
							<li><a href="#SimAlgo">Simulation algorithms</a></li>
							<ul>
								<li><a href="#QS">Parameters for QS</a></li>
								<li><a href="#NDS">Parameters for NDS</a></li>
							</ul>
							<li><a href="#example">Examples</a></li>
							<li><a href="#Benchmarking">Benchmarking</a></li>
							<li><a href="#How2Cite">How to cite ?</a></li>
							<li><a href="faq.html" target="_blank">HowTo</a></li>
						</ul>
					</aside>
				</div>
			</aside>
			<section id="main-content">

				<p style="font-size: 25px;color:red;border: 2px solid;padding: 0px 18px; text-align: center">
					<strong>&#10132;</strong> Final version of QuickSampling available <a href="https://doi.org/10.5194/gmd-13-2611-2020">here</a>.
				</p>
				<h1  id='briefOverview'>Brief overview</h1>
				<p>The <strong>GeoStatistical Server (G2S)</strong>  is a framework that allows you to use state-of-the-art <strong>Multiple Point Statistics (MPS)</strong> algorithms to run stochastic simulations.</p>

				<p><strong>G2S</strong> is designed to run simulations in a generic way, independently of the code used or language it is written in. For example, it enables to run a <em>C/C++</em> simulation code using <em>Python</em>, or <em>Python</em> using <em>MATLAB</em> (or any other combination).</p>

				<p>Currently, the framework is provided with:
					<ul>
						<li><strong>QuickSampling (QS)</strong> <i>(aka. Quantile Sampling)</i> is a general-purpose pixel-based MPS algorithm, that is designed to be robust, efficient and run in constant time. QS was designed to adapt to your problem, it can be used to do (un)conditional simulation, gap filling or even downscaling, using continuous or categorial variable or a combination of both. The code was developed without restrictions regarding the dimentionality of the data (e.g. 1D, 2D, 3D, nD).</li>
						<strong>&#10132;</strong> A journal article published in Geoscientific Model Development describes the method <a href="https://gmd.copernicus.org/articles/13/2611/2020/">here</a>.
						<li><strong>Narrow Distribution Selection (NDS)</strong> is an algorithm specifically targeted to simulate spectrally enhanced remote sensed imagery. It requires an external variable (for example, a grayscale image) to control the simulation (of colors) </li>
						&#10132; A paper describing it is available here: <a href="https://doi.org/10.1016/j.isprsjprs.2018.11.003">Analogue-based colorization of remote sensing images using textural information</a>.
					</ul>

					<p>The framework can be easily extended to handle most codes that use gridded data. Currently any compiled code or python code can be handled.</p>
					<p>For a hands-on introduction to MPS (PPT slides, Colab Notebook & recorded tutorial), follow <a href="https://github.com/GAIA-UNIL/Short-course-MPS">this link</a>.

					<h1 id='install'>Installation</h1>

					<p>Because life is short, we designed tools to make it simple. &#x1F609 <br> Except if you plan to run simulations on a remote computer, 
						you need to install both the server and the interfaces on the same machine. Please choose the options below that match your needs.
						 <br> If you ever need to update G2S, simply pull the changes from the Github repository and recompile (last step of the manual installation). 
						</p>
					<div class="osChoice buttonChoice">
						<a data-os="linux" class="button linux">Linux</a>
						<a data-os="macOS" class="button macOS">macOS</a>
						<a data-os="windows" class="button windows">Windows</a>
						<a data-os="linux" class="button cluster" href='clusterInstallation.html' target="_blank">Cluster</a>
					</div>
					<div class="installationChoice buttonChoice">
						<a data-install="server" class="button server">Server</a>
						<a data-install="interface" class="button interface">Interface</a>
					</div>
					<div class="quickSelect server installSens">
						<h2 id='installServer'>Installation of the server</h2>
						<div class="quickSelect linux server osSens">
							<h3>Installation of the server on Ubuntu</h3>
							<h4>Automatic with GCC on Ubuntu</h4>
							<ol>
								<li>First clone the code from this GitHub:<br><code>git clone https://github.com/GAIA-UNIL/G2S.git</code></li>
								<li>Then run <code>build/c++-build/install_needs_W_VM.sh</code></li>
							</ol>
							<h4>Manual (including Intel C++ Compiler)</h4>
							<ol>
								<li>First clone the code from this GitHub:<br><code>git clone https://github.com/GAIA-UNIL/G2S.git</code></li>
								<li>Basics for compiling are needed (e.g. on Ubuntu: build-essential).</li>
								<li>The following packages are required: ZMQ, JsonnCpp and zlib for G2S; fftw3 for QS and NDS.</li>
								<li>To install them on Ubuntu:<code>sudo apt install build-essential libzmq3-dev libjsoncpp-dev zlib1g-dev libfftw3-dev libcurl4-openssl-dev -y</code>(libcurl4-openssl-dev is optional)</li>
								<li>The C++ extension for ZMQ is required too, and can be installed via: <code>wget "https://raw.githubusercontent.com/zeromq/cppzmq/master/zmq.hpp" -O ./include/zmq.hpp</code></li>
								<li>Go to the build subfolder.</li>
								<li>Run: <code>make -j</code>, if the Intel C++ compiler is installed, the adapted version will be compiled too. The Intel compiler can be downloaded freely in many cases: <a href="https://software.intel.com/en-us/qualify-for-free-software">here</a>.
								<br> To manually select between GCC or Intel compiler use <code>make c++ -j</code> or <code>make intel -j</code>, respectively.
								</li>
							</ol>
						</div>
						<div class="quickSelect macOS server osSens">
							<h3>Installation of the server on macOS</h3>
							<h4>using MacPort</h4>
							<ol>
								<li>First clone the code from this GitHub:<br><code>git clone https://github.com/GAIA-UNIL/G2S.git</code></li>
								<li>Install the package manager <a href="https://www.macports.org/install.php">MacPort</a> (if not already done)</li>
								<li>The following packages are required: ZMQ, JsonnCpp and zlib for G2S. fftw3 for QS and NDS.</li>
								<li>To install them with macPort:<code>sudo port install zmq-devel jsoncpp-devel zlib cppzmq-devel fftw-3 fftw-3-single curl</code> (curl is optional)</li>
								<li>Go to the build subfolder.</li>
								<li>Run: <code>make -j</code>, if the Intel C++ compiler is installed the adapted version will be compiled too. The Intel compiler can be downloaded freely in many cases: <a href="https://software.intel.com/en-us/qualify-for-free-software">here</a>.
								<br> To manually select between GCC or Intel compiler use <code>make c++ -j</code> or <code>make intel -j</code>, respectively.
							</ol>
							<h4>using Homebrew</h4>
							<ol>
								<li>First clone the code from this GitHub:<br><code>git clone https://github.com/GAIA-UNIL/G2S.git</code></li>
								<li>Install the package manager <a href="https://brew.sh/">Homebrew</a> (if not already done)</li>
								<li>The following packages are required: ZMQ, JsonnCpp and zlib for G2S. fftw3 for QS and NDS.</li>
								<li>To install them with macPort:<code>brew install fftw zmq jsoncpp curl</code> (curl is optional)</li>
								<li>The C++ extension for ZMQ is required too, and can be installed via: <code>curl -o /usr/local/include/zmq.hpp "https://raw.githubusercontent.com/zeromq/cppzmq/master/zmq.hpp"</code></li>
								<li>Go to the build subfolder.</li>
								<li>Run: <code>make -j</code>, if the Intel C++ compiler is installed the adapted version will be compiled too. The Intel compiler can be downloaded freely in many cases: <a href="https://software.intel.com/en-us/qualify-for-free-software">here</a>.
								<br> To manually select between GCC or Intel compiler use <code>make c++ -j</code> or <code>make intel -j</code>, respectively.
							</ol>
						</div>
						<div class="quickSelect windows server osSens">
							<h3>Installation of the server on Windows 10</h3>
							<ol>
								<li>Check that the latest updates of Windows are installed</li>
								<li>Install WSL following <a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">these instructions</a>, and select a Linux distribution (we recommend choosing Ubuntu for beginners).</li>
								<li>Clone the code from this GitHub repository: https://github.com/GAIA-UNIL/G2S.git (or download and unzip the zip-file on the top right of this page).
								<li>In Windows, go to the directory <code>build/c++-build</code></li> and run/double-click <code>install.bat</code>. 
							</ol>
						</div>
					</div>
					<div class="quickSelect interface installSens">
						<h2 id='installInter'>Installation of interfaces</h2>
						<div class="progLangChoice buttonChoice">
							<a data-progLang="python" class="button python"><img class="logo python" src="https://www.mgravey.com/assets/logo/Python.svg">Python</a>
							<a data-progLang="matlab" class="button matlab"><img class="logo matlab" src="https://www.mgravey.com/assets/logo/Matlab.png">MATLAB</a>
							<a data-progLang="R-lang" class="button tooltip R-lang" disabled>R
								<span class="tooltiptext">No one reported to use the R interface, if you need it please contact me at: g2s@mgravey.com</span>
							</a>
						</div>
						<div class="quickSelect linux interface python osSens langSens">
							<h3>Installation of the Python interface on Ubuntu</h3>
							<h4>Automatic installation</h4>
							<p>Simply use <code>pip install G2S</code></p>
							<h4>Manual compilation</h4>
							<ol>
								<li>If needed Python and Numpy: <code>sudo apt install python3-distutils python3-dev python3-numpy -y</code></li>
								<li>(A C++ compiler with c++17 is required)</li>
								<li>Go to <code>build/python-build</code></li>
								<li>Run <code>python3 setup.py install --user</code></li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <br><code>from g2s import g2s; g2s('--version')</code></p>
						</div>
						<div class="quickSelect linux interface matlab osSens langSens">
							<h3>Installation of the MATLAB interface on Ubuntu</h3>
							<ol>
								<li>(A C++ compiler with c++17 is required)</li>
								<li>Open MATLAB</li>
								<li>Go to <code>build/matlab-build</code></li>
								<li>Run <code>CompileG2S</code></li>
								<li>Add compiled file in the MATLAB path</li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <code>g2s('--version')</code></p>
						</div>
						<div class="quickSelect linux interface R-lang osSens langSens progLang2hide">
							<h3>Installation of the R interface on Ubuntu</h3>
						</div>
						<div class="quickSelect macOS interface python osSens langSens">
							<h3>Installation of the Python interface on macOS</h3>
							<h4>Automatic installation</h4>
							<p>Use simply <code>pip install G2S</code></p>
							<h4>Manual compilation</h4>
							<ol>
								<li>If needed, Python and Numpy:<code>sudo port install python37 py37-numpy</code></li>
								<li>Go to <code>build/python-build</code></li>
								<li>Run <code>python3 setup.py install --user</code></li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <br><code>from g2s import g2s; g2s('--version')</code></p>
						</div>
						<div class="quickSelect macOS interface matlab osSens langSens">
							<h3>Installation of the MATLAB interface on macOS</h3>
							<ol>
								<li>Open MATLAB</li>
								<li>Go to <code>build/build-matlab</code></li>
								<li>Run <code>CompileG2S</code></li>
								<li>Add compiled file in the MATLAB path</li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <code>g2s('--version')</code></p>
						</div>
						<div class="quickSelect macOS interface R-lang osSens langSens progLang2hide">
							<h3>Installation of the R interface on macOS</h3>
						</div>
						<div class="quickSelect windows interface python osSens langSens">
							<h3>Installation of the Python interface on Windows 10</h3>
							<h4>Automatic installation</h4>
							<p>Use simply <code>pip install G2S</code></p>
							<h4>Manual compilation</h4>
							<ol>
								<li>(A C++ compiler with c++17 is required)</li>
								<li>If needed, install <a href="https://www.python.org/downloads/">python</a> with the option to add it to the Path</li>
								<li>Go to <code>build/python-build</code></li>
								<li>Run <code>python3 setup.py install</code></li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <br><code>from g2s import g2s; g2s('--version')</code></p>
						</div>
						<div class="quickSelect windows interface matlab osSens langSens">
							<h3>Installation of the MATLAB interface on Windows 10</h3>
							<h4>Download precompiled interfaces</h4>
							<ol>
								<li> Download <a href="https://github.com/GAIA-UNIL/G2S-compiled-interfaces/raw/master/latest/MATLAB/Windows/G2S-latest.win-amd64-matlab.zip">here</a>.</li>
								<li>Unzip and add the folder to MATLAB path.</li>
							</ol>
							<h4>Manual compilation</h4>
							<ol>
								<li>If needed, install <a href="https://www.python.org/downloads/">python</a> with the option to add it to the Path</li>
								<li>Open MATLAB</li>
								<li>Install a compiler with c++17, available <a href="https://visualstudio.microsoft.com/en/downloads">here (2017 or later)</a></li>
								<li>Go to <code>build/build-matlab</code></li>
								<li>Run <code>CompileG2S</code></li>
								<li>Add compiled file in the MATLAB path</li>
							</ol>
							<h4>Check proper interface installation</h4>
							<p>Simply run <code>g2s('--version')</code></p>
						</div>
						<div class="quickSelect windows interface R-lang osSens langSens progLang2hide">
							<h3>Installation of the R interface on Windows 10</h3>
						</div>
					</div>

					<h1 id='runServer'>Run the server</h1>
					<p>⚠️The server generates logs- and data-files in subfolders build/build-*/logs and build/build-*/data that are originally saved for debug purpose, and are currently automatically removed only at the launch of the server or after one day. This parameterization can be changed with -kod and -age</p>

					<div class="osChoice buttonChoice">
						<a data-os="linux" class="button linux">Linux</a>
						<a data-os="macOS" class="button macOS">macOS</a>
						<a data-os="windows" class="button windows">Windows</a>
					</div>
					<div class="quickSelect linux osSens">
						<h3>Run the server on Ubuntu</h3>
						<p>Run <code>./server</code> in <code>build/c++-build</code> or <code>build/intel-build</code>, respectively for the standard or Intel version</p>
					</div>
					<div class="quickSelect macOS osSens">
						<h3>Run the server on macOS</h3>
						<p>Run <code>./server</code> in <code>build/c++-build</code> or <code>build/intel-build</code>, respectively for the standard or Intel version</p>
					</div>
					<div class="quickSelect macOS linux osSens ">
						<table class="parameter g2s server">
							<thead>
								<tr>
									<th>Flag</th>
									<th>Description</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="addCopy">-d</td>
									<td>Run as daemon</td>
								</tr>
								<tr>
									<td class="addCopy">-To&nbsp;n</td>
									<td>Shutdown the server if there is no activity after n seconds, 0 for &infin; (default : 0)</td>
								</tr>
								<tr>
									<td class="addCopy">-p</td>
									<td>Select a specific port for the server (default: 8128)</td>
								</tr>
								<tr>
									<td class="addCopy">-kod</td>
									<td>Keep old data, if the flag is not present all files from previous runs are erased at launch</td>
								</tr>
								<tr>
									<td class="addCopy">-age</td>
									<td>Set the time in second after files need to be removed (default: 86400 s = 1d)</td>
								</tr>
							<thead>
								<th colspan="3"> Advanced parameters </th>
							</thead>
								<tr>
									<td class="addCopy">-mT</td>
									<td>Single job at a time (excludes the use of -after, only use if you're sure to be the only one accessing the server)</td>
								</tr>
								<tr>
									<td class="addCopy">-fM</td>
									<td>Run as a function, without fork</td>
								</tr>
								<tr>
									<td class="addCopy">-maxCJ&nbsp;n</td>
									<td>Limit the maximum number of jobs running in parallel.</td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="quickSelect windows osSens">
						<h3>Run the server on Windows 10</h3>
						It is possible to run the server with <code>runServer.bat</code> or <code>runDaemon.bat</code> as daemon available in <code>build/c++-build</code>
					</div>

					<h1 id='userInterface'>Using the interfaces</h1>
					<p>A call to <strong>g2s</strong> is needed to launch any computation.<br><br>
						Usage: <code>[sim,index,time,finalprogress,jobid] = g2s(flag1,value1, flag2,value2, ...)</code><br>
						Outputs: sim=simulation, index=index of the simulated values in the flattened TI, time=simulation time, finalprogress=final progression of the simulation (normally 100), jobid=job ID. <br><br>
						Flags do <strong>NOT</strong> have a specific order.</p>
					<div class="progLangChoice buttonChoice">
						<a data-progLang="python" class="button python"><img class="logo python" src="https://www.mgravey.com/assets/logo/Python.svg">Python</a>
						<a data-progLang="matlab" class="button matlab"><img class="logo matlab" src="https://www.mgravey.com/assets/logo/Matlab.png">MATLAB</a>
						<a data-progLang="R-lang" class="button tooltip R-lang" disabled>R
							<span class="tooltiptext">No one reported to use the R interface, if you need it please contact me at: g2s@mgravey.com</span>
						</a>
					</div>

					<div class="quickSelect python langSens osSens">
						<h3>Use g2s in Python</h3>
						<pre class="highlight"><code>from g2s import g2s<br>data=g2s(...)	# it returns an tuple that contains all the output maps and the computing duration</code></pre>
					</div>
					<div class="quickSelect matlab langSens osSens">
						<h3>Use g2s in MATLAB</h3>
						<pre class="highlight"><code>data=g2s(...)		% principal output, the simulation<br>[data, t]=g2s(...)	% the simulation and the computation time<br>[data, ...,t]=g2s(...)	% the simulation, other outputs map and the computation time</code></pre>
					</div>
					<div class="quickSelect R-lang langSens osSens progLang2hide">
						<h3>Use g2s in R</h3>
						<<pre class="highlight"><code></code></pre>
					</div>
					<p>Each call to <strong>g2s</strong> is composed of parameters of G2S and of the name of the algorithm used.</p>

					<table class="parameter g2s interface">
						<thead>
							<tr>
								<th>Flag</th>
								<th>Description</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="addCopy">--version</td>
								<td>Return the version and compilation date of the interface</td>
							</tr>
							<tr>
								<td class="addCopy">-a</td>
								<td>The simulation algorithm to be used, it can be 'qs', 'nds', 'ds-l' (DS-like, not maintained)</td>
							</tr>
							<tr>
								<td class="addCopy">-sa</td>
								<td>Server address (default: localhost (the server is local), otherwise provide IP address)<br>Nice when we have a powerful machine dedicated for computation</td>
							</tr>
							<tr>
								<td class="addCopy">-silent</td>
								<td>Don't display the progression, useful for scripts</td>
							</tr>
							<tr>
								<td class="addCopy">-serverStatus</td>
								<td>Inform if the server is working properly <br><1 &#8594; error, such as comunication, server shutdown,...)<br>=0 &#8594; undefined <br>>1 &#8594; server is operational <br>1: standard server working normaly</td>
							</tr>
							<tr>
								<td class="addCopy">-noTO</td>
								<td>Deactivate TimeOut on ZMQ communication, useful for slow network (e.g., through internet)</td>
							</tr>
							<tr>
								<td class="addCopy">-TO</td>
								<td>Specify a custom TimeOut on ZMQ communication( uint32 in millisecond )</td>
							</tr>
							<tr>
								<td class="addCopy">-shutdown</td>
								<td>Shutdown the server, useful at the end of scripts</td>
							</tr>
						</tbody>
					</table>
					<br>
					<p>The following options represent the <b>Asynchronous mode</b>, which allows you to submit multiple jobs simultaneously and retrieve the results of each of them later on (as opposed to synchronous communication with the server, where 
					you need to wait until a job is finished before you can submit a new one). You launch the async mode by simply adding the -submitOnly flag to your g2s call. This will give only the job ID as an output, so the g2s call becomes
					<code>jobid = g2s(flag1,value1, flag2,value2, ...)</code>. Don't forget to always include the server address if it's not local! See the example section for a demonstration in <i>MATLAB</i> and <i>Python</i>.</p>
					<table class="parameter g2s interface async">
						<thead>
							<tr>
								<th>Flag</th>
								<th>Description</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td class="addCopy">-submitOnly</td>
								<td>Submit a job</td>
							</tr>
							<tr>
								<td class="addCopy">-statusOnly</td>
								<td>Check progression <br>Usage: <code>status = g2s('-statusOnly',jobid)</code></td>
							</tr>
							<tr>
								<td class="addCopy">-waitAndDownload</td>
								<td>Download the result <br>Usage: <code>sim,_ = g2s('-waitAndDownload',jobid</code>)</td>
							</tr>
							<tr>
								<td class="addCopy">-kill</td>
								<td>Kill a given task <br>Usage: <code>g2s('-kill',jobid)</code></td>
							</tr>
							<tr>
								<td class="addCopy">-after</td>
								<td>Execute the job after another one is finished (e.g. '-after',previousJobId )</td>
							</tr>
						</tbody>
					</table>

					<h1 id='SimAlgo'>Simulation algorithms</h1>
					<p><b>G2S</b> is provided with standard state-of-the-art algorithms:
						<ul>
							<li>
								QS (aka. QuickSampling)
							</li>
							<li>
								NDS (aka. Narrow Distribution Selection)
							</li>
						</ul>
					</p>

					<div class="algoChoice buttonChoice">
						<a data-algo="qs" class="button qs">QS</a>
						<a data-algo="nds" class="button nds">NDS</a>
						<!--<a data-algo="ds-l" class="button ds-l" disabled>ds-l
							<span class="tooltiptext">No one reported to use the R interface, if you need it please contact me at: g2s@mgravey.com</span>
						</a>-->
					</div>

					<div class="quickSelect algoSens qs">
						<h2 id='QS'>Parameters for QS</h2>
						<table class="parameter qs">
							<thead>
								<tr>
									<th>Flag</th>
									<th>Description</th>
									<th>Mandatory</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="addCopy">-ti</td>
									<td>Training images (one or more images). If multivariate, the last dimension should be the same size as the number of variables, and should also match the size of the array given for the parameter dt. 
									<br> NaN values in the training image will be ignored. <br> Unlike other MPS-algorithms, if there are multiple variables they will <b>not</b> be automatically normalized to be in the same range. 
									
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-di</td>
									<td>Destination image (one image, aka simulation grid). The size of di will be the size of the simulation grid. di can be identical as ti for gap-filing. <br> NaN values will be simulated. Non-NaN values will be considered as conditioning data.</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-dt</td>
									<td>Data type. 0 &rarr; continuous and 1 &rarr; categorical <br> <p style="color:red;">This is where the number of variables is defined.</p> Provide a list containing zeros or ones representing the data type of each variable.</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-k</td>
									<td>Number of best candidates to consider &#x2208[1 &infin;]</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-n</td>
									<td>N closest neighbors to consider. If multiple variables: <br> - use a single N value if identical for all variables<br> - Use an array of N values if each variable has a different N</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-ki</td>
									<td>Image of the weighting kernel. Can be used to normalize the variables. If multiple variables: <br> - use a single kernel value if identical for all variables<br> - If each variable has a different kernel, stack all kernels along the last dimension. The number of kernels should then match the size of the array given for the parameter dt</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-f</td>
									<td>f=1/k equivalent to f of DS with a threshold to 0</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-j</td>
									<td>To run in parallel (default is single core). To use as follows '-j', N1, N2, N3 (all three are optional but N3 needs N2, which in turn needs N1). <br> Use integer values to specify a number of threads (or logical cores). 
										Use decimal values &isin;]0,1[ to indicate fraction of the maximum number of available logical cores (e.g., 0.5=50% of all available logical 
										cores).<br>- N1 threads used to parallelize the path (path-level) Default: the maximum number of threads available.<br>- N2 threads used to 
										parallelize over training images (if many TIs are available, each is scanned on a different core). Default: 1<br>- N3 threads used to 
										parallelize FFTs (node-level). Default: 1<br>- N1 and N2 are recommended over N3. N1 is usually more efficient than N2, but requires more memory.</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-sp</td>
									<td>Simulation path, array of the size of the simulation grid containing values that specify the simulation path (from low to high). 
									Default is a random path. Equal values are accepted but will always be ordered in the same way (i.e. not random). -&infin; values are not simulated. 
									In case of multiple variables, a vector simulation is default (same path for all variables) and the simulation path should be one dimension less than the number of variables. 
									If you prefer a full simulation, provide an array containing the path for each variable and use the "-fs" flag below.</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-s</td>
									<td>Random seed value</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-W_GPU</td>
									<td>Use integrated GPU if available</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-W_CUDA</td>
									<td>Use Nvidia Cuda compatible GPU: specify the device id. (e.g., <code>'-W_CUDA',0,1</code> to use the first two GPUs)</td>
									<td></td>
								</tr>
							<thead>
								<th colspan="3"> Advanced parameters </th>
							</thead>
								<tr>
									<td class="addCopy">-ii</td>
									<td>Array that specifies for each pixel which training image to sample from. Default: all training images are searched for the best match. </td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-far</td>
									<td>Fast and risky &#x1f604, like -ii but with a random input (experimental)</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-cti</td>
									<td>With this flag QS will treat the training image(s) as periodic (aka circular or cyclic) over each dimension.</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-csim</td>
									<td>With this flag QS will make sure to create a periodic (aka circular or cyclic) simulation over each dimension.</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-adsim</td>
									<td>Augmented dimentionality simulation: allows for 3D simulation using 2D training image, only for categories <i>(Coming <del>soon</del> maybe some day!)</i></td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-fs</td>
									<td>Full simulation: follows a different simulation path for each variable (as opposed to vector simulation, where the same simulation path is used for all variables).</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-nV</td>
									<td>No Verbatim, i.e. prohibits neighbors in the training image to be neighbors in the simulation. (experimental)</td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="quickSelect algoSens nds">
						<h2 id='NDS'>Parameters for NDS</h2>
						<table class="parameter nds">
							<thead>
								<tr>
									<th>Flag</th>
									<th>Description</th>
									<th>Mandatory</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td class="addCopy">-ti</td>
									<td>Training images (one or more images). If multivariate, the last dimension should be the same size as the number of variables, and should also match the size of the array given for the parameter dt. 
									<br> NaN values in the training image will be ignored. <br> Unlike other MPS-algorithms, if there are multiple variables they will <b>not</b> be automatically normalized to be in the same range. 
									</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-di</td>
									<td>Destination image (one image, aka simulation grid). The size of di will be the size of the simulation grid. di can be identical as ti for gap-filing. <br> NaN values will be simulated. Non-NaN values will be considered as conditioning data.</td>
									</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-dt</td>
									<td>Data type. 0 &rarr; continuous and 1 &rarr; categorical <br> <p style="color:red;">This is where the number of variables is defined.</p> If multiple variables: <br> - use a single N value if identical for all variables<br> - Use an array of N values if each variable has a different N.</td>
									</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-k</td>
									<td>Number of best candidates to consider to compute the narrowness &#x2208[5 &infin;]</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-n</td>
									<td>N closest neighbors to consider</td>
									<td>&#x2714</td>
								</tr>
								<tr>
									<td class="addCopy">-ki</td>
									<td>Image of the weighting kernel. Can be used to normalize the variables. If multiple variables: <br> - use a single kernel value if identical for all variables<br> - If each variable has a different kernel, stack all kernels along the last dimension. The number of kernels should then match the size of the array given for the parameter dt</td>
									</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-nw</td>
									<td>Narrowness range  0&rarr; max-min, 1 &rarr; median, default IQR &rarr; 0.5</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-nwv</td>
									<td>Number of variables to consider in the narrowness, (start from the end), default: 1</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-cs</td>
									<td>Chunk size, the number of pixels to simulate at the same time, at each iteration, default: 1</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-uds</td>
									<td>Area to update around each simulated pixel, the M closest pixel default: 10</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-mp</td>
									<td>Partial simulation, 0 &rarr; empty, 1 &rarr; 100%</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-s</td>
									<td>Seed value</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-j</td>									
										<td>To run in parallel (default is single core). To use as follows '-j', N1, N2, N3 (all three are optional but N3 needs N2, which in turn needs N1). <br> Use integer values to specify a number of threads (or logical cores). 
										Use decimal values &isin;]0,1[ to indicate fraction of the maximum number of available logical cores (e.g., 0.5=50% of all available logical 
										cores).<br>- N1 threads used to parallelize the path (path-level) Default: the maximum number of threads available.<br>- N2 threads used to 
										parallelize over training images (if many TIs are available, each is scanned on a different core). Default: 1<br>- N3 threads used to 
										parallelize FFTs (node-level). Default: 1<br>- N1 and N2 are recommended over N3. N1 is usually more efficient than N2, but requires more memory.</td>
									</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-W_GPU</td>
									<td>Use integrated GPU if available</td>
									<td></td>
								</tr>
								<tr>
									<td class="addCopy">-nV</td>
									<td>No Verbatim (experimental)</td>
									<td></td>
								</tr>
							</tbody>
						</table>
					</div>

					<h1 id='example'>Examples</h1>
					<p> Some copy-paste examples are provided here for demonstration purposes. Feel free to play around with the parameters and with different training images (we collected some <a href="https://github.com/GAIA-UNIL/TrainingImagesTIFF">here</a>), 
					but keep in mind that these are just quick examples. For proper implementations please check the literature. 
						<br>
						For additional examples with more detailed explanation check out the Colab notebook accompanying our <a href="https://github.com/GAIA-UNIL/Short-course-MPS">hands-on introduction to MPS</a>.
					</p>
					<div class="progLangChoice buttonChoice">
						<a data-progLang="python" class="button python"><img class="logo python" src="https://www.mgravey.com/assets/logo/Python.svg">Python</a>
						<a data-progLang="matlab" class="button matlab"><img class="logo matlab" src="https://www.mgravey.com/assets/logo/Matlab.png">MATLAB</a>
						<a data-progLang="R-lang" class="button tooltip R-lang" disabled>R
							<span class="tooltiptext">So far no one reported the need for an R interface, if you need it please contact me at: g2s@mgravey.com</span>
						</a>
					</div>
					<div class="algoChoice buttonChoice">
						<a data-algo="qs" class="button qs">QS</a>
						<a data-algo="nds" class="button nds">NDS</a>
						<a data-algo="asyncMode" class="button asyncMode">Mode asynchronous</a>
						<!--<a data-algo="ds-l" class="button ds-l" disabled>ds-l
							<span class="tooltiptext">No one reported to use the R interface, if you need it please contact me at: g2s@mgravey.com</span>
						</a>-->
					</div>
					<div class="quickSelect algoSens qs">
						<h2>Example of using QS</h2>
						<div class="exampleChoice buttonChoice">
							<a data-example="unconditionalSimulation" class="button unconditionalSimulation">Unconditional simulation</a>
							<a data-example="conditionalSimulation" class="button conditionalSimulation">Conditional simulation</a>
							<a data-example="MultiTI" class="button MultiTI">Multiple TI's</a>
							<a data-example="multivariateSimulation" class="button multivariateSimulation">Multivariate simulation</a>
							<a data-example="gapFilling" class="button gapFilling">Gap filling</a>
							<a data-example="downsacling" class="button downsacling">Downscaling</a>
							<a data-example="3D" class="button 3D">3D</a>
							<!--<a data-algo="ds-l" class="button ds-l" disabled>ds-l
								<span class="tooltiptext">No one reported to use the R interface, if you need it please contact me at: g2s@mgravey.com</span>
							</a>-->
						</div>
						<div class="quickSelect unconditionalSimulation exampleSens python langSens">
							<h3>Unconditional simulation using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/unconditionalSimulation.py"></code></pre>
						</div>
						<div class="quickSelect unconditionalSimulation exampleSens matlab langSens">
							<h3>Unconditional simulation using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-MATLAB" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/unconditionalSimulation.m"></code></pre>
						</div>
						<div class="quickSelect conditionalSimulation exampleSens python langSens">
							<h3>Conditional simulation using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/conditionalSimulation.py"></code></pre>
						</div>
						<div class="quickSelect conditionalSimulation exampleSens matlab langSens">
							<h3>Conditional simulation using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/conditionalSimulation.m"></code></pre>
						</div>
						<div class="quickSelect MultiTI exampleSens python langSens">
							<h3>Simulation with multiple Training Images using python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/Multiple_TI.py"></code></pre>
						</div>
						<div class="quickSelect MultiTI exampleSens matlab langSens">
							<h3>Simulation with multiple Training Images using Matlab</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/Multiple_TI.m"></code></pre>
						</div>
						<div class="quickSelect multivariateSimulation exampleSens python langSens">
							<h3>Multivariate simulation using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/multivariateSimulation.py"></code></pre>
						</div>
						<div class="quickSelect multivariateSimulation exampleSens matlab langSens">
							<h3>Multivariate simulation using Matlab</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/multivariateSimulation.m"></code></pre>
						</div>
						<div class="quickSelect gapFilling exampleSens python langSens">
							<h3>Gap filling using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/gapFilling.py"></code></pre>
						</div>
						<div class="quickSelect gapFilling exampleSens matlab langSens">
							<h3>Gap filling using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/gapFilling.m"></code></pre>
						</div>
						<div class="quickSelect downsacling exampleSens python langSens">
							<h3>Downscaling using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/downscaling.py"></code></pre>
						</div>
						<div class="quickSelect downsacling exampleSens matlab langSens">
							<h3>Downscaling using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/downscaling.m"></code></pre>
						</div>
						<div class="quickSelect 3D exampleSens python langSens">
							<h3>3D simulation using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/3D.py"></code></pre>
						</div>
						<div class="quickSelect 3D exampleSens matlab langSens">
							<h3>3D simulation using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/3D.m"></code></pre>
						</div>
					</div>

					<br>
					<div class="quickSelect algoSens nds">
						<h2>Example of using NDS</h2>
						<div class="exampleChoice buttonChoice">
							<a data-example="RGB2IR" class="button RGB2IR">RGB&#x21d2IR</a>
							<a data-example="Pan2RGB" class="button Pan2RGB">Pan&#x21d2RGB</a>
							<a data-example="Pan2IR" class="button Pan2IR">Pan&#x21d2IR</a> 
						</div>
						<div class="quickSelect RGB2IR exampleSens python langSens">
							<h3>Spectral enhancement: RGB&#x21d2IR using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/RGB2IR.py"></code></pre>
						</div>
						<div class="quickSelect RGB2IR exampleSens matlab langSens">
							<h3>Spectral enhancement: RGB&#x21d2IR using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/RGB2IR.m"></code></pre>
						</div>
						<div class="quickSelect Pan2RGB exampleSens python langSens">
							<h3>Spectral enhancement: Pan&#x21d2RGB  using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/Pan2RGB.py"></code></pre>
						</div>
						<div class="quickSelect Pan2RGB exampleSens matlab langSens">
							<h3>Spectral enhancement: Pan&#x21d2RGB using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/Pan2RGB.m"></code></pre>
						</div>
						<div class="quickSelect Pan2IR exampleSens python langSens">
							<h3>Spectral enhancement: Pan&#x21d2IR using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/Pan2IR.py"></code></pre>
						</div>
						<div class="quickSelect Pan2IR exampleSens matlab langSens">
							<h3>Spectral enhancement: Pan&#x21d2IR using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/Pan2IR.m"></code></pre>
						</div>
					</div>
					
					<br>
					<div class="quickSelect algoSens asyncMode">
						<h2>Example of using asynchronous request to G2S</h2>
						
						<div class="quickSelect exampleSens python langSens">
							<h3>Asynchronous call using Python</h3>
							<p></p>
							<pre class="highlight"><code class="language-python" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/python/async_mode.py"></code></pre>
						</div>
						<div class="quickSelect exampleSens matlab langSens">
							<h3>Asynchronous call using MATLAB</h3>
							<p></p>
							<pre class="highlight"><code class="language-matlab" src="https://raw.githubusercontent.com/GAIA-UNIL/G2S/master/example/matlab/async_mode.m"></code></pre>
						</div>
					</div>


				<h1 id="Benchmarking">Benchmarking</h1>
				<p>This code <strong><u>CAN</u></strong> be used for benchmarking (and I invite you to do so &#x1F609), the code needs to run natively on macOS or on Linux <u>using the Intel Compiler with MKL library</u>. The version needs to be reported, and the time <u>needs</u> to be the time reported by the algorithm (that is the true execution time without taking into account interfaces overhead).</p>

				<p>When benchmarking, the code should <strong><u>NOT</u></strong> be used inside a Virtual Machine or through WSL on Windows 10+.</p>

				<h1 id="How2Cite" >How to cite ?</h1>
				<div>
					<h2>For QuickSampling</h2>
					<p>Gravey, M., & Mariethoz, G. (2020). QuickSampling v1.0: a robust and simplified pixel-based multiple-point simulation approach. Geoscientific Model Development, 13(6), 2611–2630. https://doi.org/10.5194/gmd-13-2611-2020</p>
					<h2>For Narrow Distribution Selection</h2>
					<p>Gravey, M., Rasera, L. G., & Mariethoz, G. (2019). Analogue-based colorization of remote sensing images using textural information. ISPRS Journal of Photogrammetry and Remote Sensing, 147, 242–254. https://doi.org/10.1016/j.isprsjprs.2018.11.003</p>
				</div>
 			</section>
			<aside id="sidebar">
				<div>
					<div id='simulationQS'>
						<p class=toHideForSmallScreen>This QS simulation is an interactive simulation, the progression is controled by the position in the page.
						</p>
						<div class=toHideForSmallScreen>
							n: <span id="nValue"></span><input type="range" min="1" max="50" value="20" class="slider" id="n"> <br>
							k: <span id="kValue"></span><input type="range" min="1" max="4" value="1.5" step=0.01 class="slider" id="k">
						</div>
						<br>
						<svg id="ti" style="width: 100%; height: auto;" viewBox="0 0 1 1.35"></svg>

						<svg id="sim" style="width: 100%; height: auto;" viewBox="0 0 1 1"></svg>

					</div>
				</div>				
			</aside>
		</div>
	</div>
	<footer>

	</footer>
</body>
</html>
